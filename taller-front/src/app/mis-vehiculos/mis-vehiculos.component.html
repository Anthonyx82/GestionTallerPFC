<h2>Mis Veh칤culos</h2>

<ng-container *ngIf="cargando">
  <div class="loading">
    <p>Cargando veh칤culos...</p>
  </div>
</ng-container>

<ng-container *ngIf="!cargando && vehiculos.length === 0">
  <ng-container *ngIf="vehiculos.length === 0">
    <div class="instructions">
      <h3>No tienes veh칤culos registrados</h3>
      <p>Para registrar un veh칤culo sigue estos sencillos pasos:</p>
      <div class="steps">
        <div class="step">
          <h4>1. Descarga la aplicaci칩n del cliente</h4>
          <p>Accede al siguiente enlace para descargar la aplicaci칩n del cliente:</p>
          <a href="https://github.com/Anthonyx82/GestionTallerPFC/releases/download/v1.0.0/client.exe" target="_blank"
            class="download-link">Descargar aplicaci칩n</a>
        </div>

        <div class="step">
          <h4>2. Conecta el veh칤culo al puerto OBDII</h4>
          <p>Conecta el cable ELM327 al puerto OBDII de tu veh칤culo. Este puerto suele encontrarse cerca del volante,
            debajo del tablero.</p>
        </div>

        <div class="step">
          <h4>3. Conecta el port치til al veh칤culo</h4>
          <p>Aseg칰rate de que el port치til que vas a usar para la conexi칩n est치 conectado al veh칤culo mediante el cable
            ELM327.</p>
        </div>

        <div class="step">
          <h4>4. Inicia sesi칩n en la aplicaci칩n</h4>
          <p>Abre la aplicaci칩n del cliente que descargaste e inicia sesi칩n con el mismo usuario y contrase침a que usaste
            para registrar tu cuenta en esta p치gina web.</p>
        </div>

        <div class="step">
          <h4>5. Los datos del veh칤culo se recopilar치n autom치ticamente</h4>
          <p>Una vez iniciada la sesi칩n, la aplicaci칩n del cliente comenzar치 a recoger todos los datos del veh칤culo de
            forma autom치tica. 춰Ya est치! Ahora tu veh칤culo aparecer치 en tu lista de veh칤culos registrados.</p>
        </div>
      </div>
    </div>
  </ng-container>
</ng-container>

<ng-container *ngIf="!cargando && vehiculos.length > 0">
  <ng-container *ngIf="vehiculos.length > 0">
    <div class="vehicle-cards">
      <div class="vehicle-card" *ngFor="let vehiculo of vehiculos">
        <!-- Botones ahora est치n fuera de image-container -->
        <button class="icon-button edit-icon" (click)="editarVehiculo(vehiculo.id)" title="Editar">
          <span class="material-icons">edit</span>
        </button>

        <button class="icon-button delete-icon" (click)="eliminarVehiculo(vehiculo.id)" title="Eliminar">
          <span class="material-icons red">delete</span>
        </button>

        <div class="image-container">
          <img [src]="vehiculo.imagenUrl || 'assets/no-image.png'" alt="{{ vehiculo.marca }} {{ vehiculo.modelo }}"
            class="vehicle-image" (click)="verDetalles(vehiculo.id)">
        </div>

        <div class="vehicle-info">
          <h3>{{ vehiculo.marca }} {{ vehiculo.modelo }}</h3>
          <p><strong>A침o:</strong> {{ vehiculo.year }}</p>
        </div>
      </div>

    </div>
  </ng-container>
</ng-container>

<!-- Modal para mostrar detalles del veh칤culo -->
<div *ngIf="vehiculoSeleccionado" class="vehicle-details-modal">
  <div class="modal-content">
    <span class="close" (click)="cerrarDetalles()">&times;</span>
    <h3>{{ vehiculoSeleccionado.marca }} {{ vehiculoSeleccionado.modelo }}</h3>
    <p><strong>A침o:</strong> {{ vehiculoSeleccionado.year }}</p>
    <p><strong>VIN:</strong> {{ vehiculoSeleccionado.vin }}</p> <!-- 游댳 Agregado VIN -->
    <p><strong>RPM:</strong> {{ vehiculoSeleccionado.rpm }}</p>
    <p><strong>Velocidad:</strong> {{ vehiculoSeleccionado.velocidad }} km/h</p>
    <h4>Errores:</h4>
    <ul>
      <li *ngFor="let error of vehiculoSeleccionado.errores">{{ error.codigo_dtc }}</li>
    </ul>
    <button class="download-button" (click)="solicitarInforme(vehiculoSeleccionado.id)">游늯 Descargar Informe</button>
  </div>
</div>

<button (click)="volverInicio()" class="cta-button">Volver al Inicio</button>